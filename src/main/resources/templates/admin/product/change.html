<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{common/head :: head_fragment('商品変更',~{::link},~{::script})}">
	<!-- このページ固有で読み込むCSS/JS -->
	<link th:href="@{/css/admin/product-change.css}" rel="stylesheet" />
	<script th:src="@{/js/admin/select-image.js}" crossorigin="anonymous"></script>
</head>

<body>
	<div class="contents">
		<div th:replace="~{common/header :: header_fragment}"></div>
		<main>
			<section class="py-5">
				<div class="container px-3 px-lg-5 mb-5">
					<div class="d-flex justify-content-center">
						<div th:if="${changeSuccessed}" class="alert alert-dismissible alert-success mb-5">
							<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
							商品情報を変更しました
						</div>
						<div th:if="${statusStpoSuccessed}" class="alert alert-dismissible alert-success mb-5">
							<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
							商品を販売停止にしました
						</div>
						<div th:if="${restartSuccessed}" class="alert alert-dismissible alert-success mb-5">
							<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
							商品を販売再開しました
						</div>
						<!-- <div class="alert alert-dismissible alert-danger mb-5">
		                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		                    画像のアップロードに失敗しました
		                </div-->
					</div>
					<form th:action="@{/admin/product/{id}(id = ${productRegistForm.productId})}" method="post"
						th:object="${productRegistForm}" id="edit-form">
						<div class="row gx-4 gx-lg-5 align-items-center">
							<div class="col-md-6 text-center mb-5">
								<div class="mb-md-0 img-wrapper">
									<img id="output" class="card-img-top bg-light" th:src="@{/img/no_image.png}"
										alt="NO IMAGE" />
									<div class="img-edit">
										<a class="nav-link dropdown-toggle py-1 px-2 image-edit-btn"
											data-bs-toggle="dropdown" role="button" aria-haspopup="true"
											aria-expanded="false">編集</a>
										<div class="dropdown-menu">
											<input type="file" name="image" id="image" accept="image/*"
												onchange="showSelectedImage(event, '#output')">
											<label class="dropdown-item" id="btn-file" for="image">写真を選択</label>
											<a class="dropdown-item"
												onclick="deleteSelectedImage('#image', '#output')">写真を削除</a>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-6">
								<span th:if="*{status} == 1" class="badge bg-danger mb-3">販売停止中</span>

								<div class="fs-5 mb-4">
									<label for="productName" class="form-label">商品名</label>
									<input type="text" th:field="*{name}" class="form-control w-100" placeholder="商品名">
									<p class="error-text" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"
										style="color: red;"></p>
								</div>
								<div class="fs-5 mb-4">
									<div>
										<label for="amount" class="form-label">価格</label>
										<div>
											<div class="input-group">
												<span class="input-group-text">¥</span>
												<input type="number" th:field="*{amount}" class="form-control"
													aria-label="価格" placeholder="1000">
												<div class="error-text" th:if="${#fields.hasErrors('amount')}"
													th:errors="*{amount}" style="color: red;">
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="fs-5 mb-4">
									<label for="description" class="form-label">商品説明</label>
									<textarea class="form-control w-100" th:field="*{description}" rows="3"
										placeholder="商品説明"></textarea>
									<p class="error-text" th:if="${#fields.hasErrors('description')}"
										th:errors="*{description}" style="color: red;"></p>
								</div>
								<div class="fs-5 mb-4">
									<label for="stock" class="form-label">在庫数</label>
									<input type="number" th:field="*{quantity}" class="form-control w-100"
										placeholder="1">
									<p class="error-text" th:if="${#fields.hasErrors('quantity')}"
										th:errors="*{quantity}" style="color: red;"></p>
								</div>
								<div class="text-center">
									<button class="btn btn-dark me-3">変更する</button>
									<button th:if="*{status} == 0" class="btn btn-danger" form="form-stop">販売停止</button>
									<button th:if="*{status} == 1" class="btn btn-info"
										form="form-restart">販売再開</button>
								</div>
							</div>
						</div>
					</form>
					<form id="form-stop" th:action="@{/admin/product/{id}/stop(id=${productRegistForm.productId})}"
						method="post"></form>
					<form id="form-restart"
						th:action="@{/admin/product/{id}/restart(id=${productRegistForm.productId})}" method="post">
					</form>
				</div>
			</section>
		</main>
		<div th:replace="~{common/footer :: footer_fragment}"></div>
	</div>
</body>

</html>